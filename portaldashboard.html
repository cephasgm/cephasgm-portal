<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Client Dashboard ‚Äî Cephas GM</title>

<!-- ‚úÖ PWA Manifest -->
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<meta name="theme-color" content="#0b7a59">

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:'Poppins',sans-serif;
  color:#fff;
  background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.8)), url('https://images.travelandleisureasia.com/wp-content/uploads/sites/3/2023/11/20202626/lauterbrunnen.jpg');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  min-height:100vh;
}
.nav{
  background:rgba(0,0,0,0.9);
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:14px 30px;
  position:sticky;
  top:0;
  border-bottom: 2px solid #0b7a59;
}
.brand{font-weight:700; color: #fff;}
.nav-links{display:flex;gap:16px;flex-wrap:wrap;}
.nav a{
  color:#fff;
  text-decoration:none;
  padding:8px 12px;
  border-radius:6px;
  transition:.3s;
}
.nav a:hover,.nav a.active{background:rgba(255,255,255,0.15);}
.logout-btn {
  background: #c0392b;
  border-radius: 6px;
}
.logout-btn:hover {
  background: #e74c3c;
}
header{
  text-align:center;
  padding:2rem 1rem;
  background:rgba(0,0,0,0.5);
  margin-bottom: 1rem;
}
header h1{color:#0b7a59;font-size:2rem;margin-bottom:.3rem;}
header p{color:#ddd;}
main{text-align:center;padding:2rem 1rem; max-width: 1200px; margin: 0 auto;}
.card{
  background:rgba(255,255,255,0.1);
  padding:2rem;
  margin:1rem auto;
  border-radius:12px;
  max-width:800px;
  box-shadow:0 0 20px rgba(0,0,0,0.4);
  backdrop-filter: blur(4px);
  border: 1px solid rgba(255,255,255,0.1);
}
.card h2{color:#0b7a59;margin-bottom:0.5rem;}
.project-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1rem;
  margin-top: 1.5rem;
}
.project-item {
  background: rgba(255,255,255,0.05);
  padding: 1.2rem;
  border-radius: 10px;
  text-align: left;
  border-left: 4px solid #0b7a59;
}
.project-item h3 { color: #0b7a59; font-size: 1.1rem; margin-bottom: 0.5rem; }
.project-item p { font-size: 0.95rem; color: #ddd; line-height: 1.5; }
.project-item .status { 
  margin-top: 0.8rem; 
  padding: 0.3rem 0.8rem; 
  background: rgba(11,122,89,0.2); 
  border-radius: 20px; 
  display: inline-block;
  font-size: 0.85rem;
}
footer{
  background:rgba(0,0,0,0.9);
  text-align:center;
  padding:1rem;
  font-size:.9rem;
  margin-top:2rem;
  color:#ccc;
  border-top: 1px solid rgba(255,255,255,0.1);
}
#ai-section{
  display:none;
  background:rgba(0,0,0,0.6);
  padding:2rem;
  margin:2rem auto;
  border-radius:12px;
  backdrop-filter: blur(4px);
  max-width: 800px;
}
#chat-box{
  height:300px;
  overflow-y:auto;
  background:rgba(255,255,255,0.1);
  border-radius:10px;
  padding:1rem;
  margin-bottom:1rem;
}
.message{margin:6px 0;}
.user{color:#0b7a59; font-weight:500;}
.assistant{color:#fff;}
.chat-input {
  display: flex;
  gap: 5px;
}
#user-input{
  flex: 1;
  padding:.7rem;
  border:none;
  border-radius:8px;
  background: rgba(255,255,255,0.1);
  color: #fff;
  border: 1px solid rgba(255,255,255,0.2);
}
#user-input::placeholder {
  color: #aaa;
}
#send-btn{
  background:#0b7a59;
  color:#fff;
  border:none;
  padding:.7rem 1.5rem;
  border-radius:8px;
  cursor:pointer;
  font-weight:500;
}
#send-btn:hover{background:#099268;}
.ai-toggle {
  background: #0b7a59;
  color: #fff;
  border: none;
  padding: 0.8rem 1.5rem;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 500;
  margin: 1rem 0;
}
.ai-toggle:hover {
  background: #099268;
}
</style>
</head>
<body>

<nav class="nav">
  <div class="brand">Cephas GM Client</div>
  <div class="nav-links">
    <a href="portaldashboard.html" class="active">Dashboard</a>
    <a href="portaldownloads.html">Downloads</a>
    <a href="#" onclick="toggleAI()">ü§ñ CephasAI</a>
    <a href="#" id="logoutBtn" class="logout-btn">Logout</a>
    <a href="https://cephasgm.github.io/cephasgm-site/" target="_blank">üåç Main Site</a>
  </div>
</nav>

<script>
  // Firebase Configuration
  const firebaseConfig = {
    apiKey: "AIzaSyB7TImJ72bH2aQ5LgQxb3XK7hD4kY9qWzM",
    authDomain: "cephasgm-portal.firebaseapp.com",
    projectId: "cephasgm-portal",
    storageBucket: "cephasgm-portal.firebasestorage.app",
    messagingSenderId: "123456789012",
    appId: "1:123456789012:web:abc123def456ghi789jkl"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  // Check authentication
  auth.onAuthStateChanged((user) => {
    if (!user) {
      window.location.href = 'portallogin.html';
    } else {
      // Set display name
      const displayName = user.email.split('@')[0];
      document.getElementById('displayName').textContent = displayName.charAt(0).toUpperCase() + displayName.slice(1);
    }
  });

  // Universal logout function
  window.logout = function() {
    auth.signOut().then(() => {
      localStorage.clear();
      sessionStorage.clear();
      window.location.href = 'portallogin.html';
    }).catch((error) => {
      console.error('Logout error:', error);
      localStorage.clear();
      window.location.href = 'portallogin.html';
    });
  };

  // Add logout event listener
  document.getElementById('logoutBtn').addEventListener('click', (e) => {
    e.preventDefault();
    logout();
  });
</script>

<header>
  <h1>Welcome, <span id="displayName">Client</span> üëã</h1>
  <p>Here's your personalized overview of active Cephas GM projects.</p>
</header>

<main>
  <div class="card">
    <h2>Your Active Projects</h2>
    <div class="project-list" id="projectList"></div>
  </div>
  
  <button class="ai-toggle" onclick="toggleAI()">ü§ñ Chat with CephasAI</button>
</main>

<section id="ai-section">
  <h2 style="color:#0b7a59;text-align:center;">ü§ñ CephasAI Assistant</h2>
  <div id="chat-box">
    <div class="message assistant"><b>CephasAI:</b> Hello! Ask me about your projects, reports, or downloads.</div>
  </div>
  <div class="chat-input">
    <input type="text" id="user-input" placeholder="Ask CephasAI...">
    <button id="send-btn">Send</button>
  </div>
</section>

<footer>Copyright ¬© 2025 Cephas GM | Enterprise Portal</footer>

<script>
const clientProjects = [
  { 
    name: 'CephasGM-ERP', 
    status: '85% Complete', 
    description: 'Enterprise Resource Planning system with financial and HR modules',
    lastUpdate: '2025-03-15'
  },
  { 
    name: 'Health-Safety-PWA', 
    status: '92% Complete', 
    description: 'Safety tracking and incident management for metal industry',
    lastUpdate: '2025-03-18'
  },
  { 
    name: 'Smart Location Tracker', 
    status: '78% Complete', 
    description: 'Real-time GPS tracking for assets and personnel',
    lastUpdate: '2025-03-14'
  },
  { 
    name: 'Client Portal', 
    status: 'Active', 
    description: 'Secure access gateway for project documentation',
    lastUpdate: '2025-03-19'
  }
];

const projectList = document.getElementById('projectList');
projectList.innerHTML = clientProjects.map(p => `
  <div class="project-item">
    <h3>${p.name}</h3>
    <p>${p.description}</p>
    <div class="status">Status: ${p.status} | Last: ${p.lastUpdate}</div>
  </div>
`).join('');

function toggleAI(){
  const ai = document.getElementById("ai-section");
  ai.style.display = ai.style.display === "none" ? "block" : "none";
}

const chat = document.getElementById("chat-box");
document.getElementById("send-btn").onclick = function(){
  const input = document.getElementById("user-input");
  const val = input.value.trim();
  if(!val) return;
  
  chat.innerHTML += `<div class="message user"><b>You:</b> ${val}</div>`;
  input.value = "";
  
  setTimeout(() => {
    const inputLower = val.toLowerCase();
    let reply = "I can help with your ERP, Safety PWA, or Location Tracker projects.";
    
    if (inputLower.includes('erp')) {
      reply = "The CephasGM-ERP system is 85% complete. Financial and HR modules are ready for demo.";
    } else if (inputLower.includes('safety') || inputLower.includes('pwa') || inputLower.includes('health')) {
      reply = "The Health & Safety PWA is at 92% completion. Incident tracking and checklists are fully functional.";
    } else if (inputLower.includes('location') || inputLower.includes('tracker') || inputLower.includes('gps')) {
      reply = "The Smart Location Tracker is 78% complete. Real-time GPS and geofencing are operational.";
    } else if (inputLower.includes('download')) {
      reply = "You can find project reports and documents in the Downloads section.";
    } else if (inputLower.includes('hello') || inputLower.includes('hi')) {
      reply = "Hello! How can I assist with your projects today?";
    }
    
    chat.innerHTML += `<div class="message assistant"><b>CephasAI:</b> ${reply}</div>`;
    chat.scrollTop = chat.scrollHeight;
  }, 800);
};

if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('service-worker.js')
      .then(reg => console.log('‚úÖ Service Worker registered:', reg.scope))
      .catch(err => console.error('‚ùå Service Worker registration failed:', err));
  });
}
</script>

</body>
</html>
